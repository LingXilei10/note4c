[1438. ç»å¯¹å·®ä¸è¶…è¿‡é™åˆ¶çš„æœ€é•¿è¿ç»­å­æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/longest-continuous-subarray-with-absolute-diff-less-than-or-equal-to-limit/solutions/612688/jue-dui-chai-bu-chao-guo-xian-zhi-de-zui-5bki/)

å¾ˆæ˜æ˜¾è¿™é“é¢˜éœ€è¦ç”¨åˆ°å‰æ–‡è®²çš„ [æ»‘åŠ¨çª—å£æŠ€å·§æ ¸å¿ƒæ¡†æ¶è¯¦è§£](https://labuladong.online/algo/essential-technique/sliding-window-framework/)ï¼š

å½“çª—å£å†…ç»å¯¹å€¼ä¹‹å·®ä¸è¶…è¿‡ `limit` æ—¶æ‰©å¤§çª—å£ï¼Œå½“æ–°åŠ å…¥çª—å£çš„å…ƒç´ ä½¿å¾—ç»å¯¹å€¼ä¹‹å·®è¶…è¿‡ `limit` æ—¶å¼€å§‹æ”¶ç¼©çª—å£ï¼Œçª—å£çš„æœ€å¤§å®½åº¦å³æœ€é•¿å­æ•°ç»„çš„é•¿åº¦ã€‚

ä½†æœ‰ä¸ªé—®é¢˜ï¼Œå½“çª—å£è¿›æ–°å…ƒç´ æ—¶ï¼Œæˆ‘å¯ä»¥æ›´æ–°çª—å£ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œä½†å½“çª—å£æ”¶ç¼©æ—¶ï¼Œå¦‚ä½•æ›´æ–°æœ€å¤§å€¼å’Œæœ€å°å€¼å‘¢ï¼Ÿéš¾é“è¦éå†ä¸€éçª—å£ä¸­çš„æ‰€æœ‰å…ƒç´ å—ï¼Ÿè¿™å°±ç”¨åˆ°å•è°ƒé˜Ÿåˆ—ç»“æ„äº†ï¼Œè¿™é‡Œéœ€è¦ä¸€ä¸ªé€šç”¨çš„ `MonotonicQueue` ç±»ï¼Œç”¨æ¥é«˜æ•ˆåˆ¤æ–­çª—å£ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚

> PSï¼š`MonotonicQueue` çš„é€šç”¨å®ç°è§ [å•è°ƒé˜Ÿåˆ—è®¾è®¡ä¸å®ç°](https://labuladong.online/algo/problem-set/monotonic-queue/)

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€å¼ºåŒ–ç»ƒä¹ ã€‘å•è°ƒé˜Ÿåˆ—çš„é€šç”¨å®ç°åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-queue/)

## è§£æ³•ä»£ç 

 cppğŸ¤– goğŸ¤– javağŸŸ¢ javascriptğŸ¤– pythonğŸ¤– 

Copy

```cpp
// æ³¨æ„ï¼šcpp ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ã€‚
// æœ¬ä»£ç çš„æ­£ç¡®æ€§å·²é€šè¿‡åŠ›æ‰£éªŒè¯ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥å¯¹ç…§ java ä»£ç æŸ¥çœ‹ã€‚

#include <deque>
#include <vector>
#include <cassert>
using namespace std;

// ä¸‹é¢ç»™å‡ºçš„æ˜¯å•è°ƒé˜Ÿåˆ—çš„é€šç”¨å®ç°ï¼Œè¿è¡Œé€Ÿåº¦å¯èƒ½è¾ƒæ…¢ï¼Œä½ å¯ä»¥è‡ªè¡Œç®€åŒ–æå‡é€Ÿåº¦
// å•è°ƒé˜Ÿåˆ—çš„è¯¦ç»†è§£æè§
// https://labuladong.online/algo/problem-set/monotonic-queue/
class MonotonicQueue {
    // å¸¸è§„é˜Ÿåˆ—ï¼Œå­˜å‚¨æ‰€æœ‰å…ƒç´ 
    deque<int> q;
    // å…ƒç´ é™åºæ’åˆ—çš„å•è°ƒé˜Ÿåˆ—ï¼Œå¤´éƒ¨æ˜¯æœ€å¤§å€¼
    deque<int> maxq;
    // å…ƒç´ å‡åºæ’åˆ—çš„å•è°ƒé˜Ÿåˆ—ï¼Œå¤´éƒ¨æ˜¯æœ€å°å€¼
    deque<int> minq;

public:
    void push(int elem) {
        // ç»´æŠ¤å¸¸è§„é˜Ÿåˆ—ï¼Œç›´æ¥åœ¨é˜Ÿå°¾æ’å…¥å…ƒç´ 
        q.push_back(elem);

        // ç»´æŠ¤ maxqï¼Œå°†å°äº elem çš„å…ƒç´ å…¨éƒ¨åˆ é™¤
        while (!maxq.empty() && maxq.back() < elem) {
            maxq.pop_back();
        }
        maxq.push_back(elem);

        // ç»´æŠ¤ minqï¼Œå°†å¤§äº elem çš„å…ƒç´ å…¨éƒ¨åˆ é™¤
        while (!minq.empty() && minq.back() > elem) {
            minq.pop_back();
        }
        minq.push_back(elem);
    }

    int max() {
        // maxq çš„å¤´éƒ¨æ˜¯æœ€å¤§å…ƒç´ 
        return maxq.front();
    }

    int min() {
        // minq çš„å¤´éƒ¨æ˜¯æœ€å¤§å…ƒç´ 
        return minq.front();
    }

    int pop() {
        // ä»æ ‡å‡†é˜Ÿåˆ—å¤´éƒ¨å¼¹å‡ºéœ€è¦åˆ é™¤çš„å…ƒç´ 
        int deleteVal = q.front();
        q.pop_front();

        // ç”±äº push çš„æ—¶å€™ä¼šåˆ é™¤å…ƒç´ ï¼ŒdeleteVal å¯èƒ½å·²ç»è¢«åˆ æ‰äº†
        if (deleteVal == maxq.front()) {
            maxq.pop_front();
        }
        if (deleteVal == minq.front()) {
            minq.pop_front();
        }
        return deleteVal;
    }

    int size() {
        // æ ‡å‡†é˜Ÿåˆ—çš„å¤§å°å³æ˜¯å½“å‰é˜Ÿåˆ—çš„å¤§å°
        return q.size();
    }

    bool isEmpty() {
        return q.empty();
    }
};

class Solution {
public:
    int longestSubarray(vector<int>& nums, int limit) {
        int left = 0, right = 0;
        int windowSize = 0, res = 0;
        MonotonicQueue window;
        // æ»‘åŠ¨çª—å£æ¨¡æ¿
        while (right < nums.size()) {
            // æ‰©å¤§çª—å£ï¼Œæ›´æ–°çª—å£æœ€å€¼
            window.push(nums[right]);
            right++;
            windowSize++;
            while (window.max() - window.min() > limit) {
                // ç¼©å°çª—å£ï¼Œæ›´æ–°çª—å£æœ€å€¼
                window.pop();
                left++;
                windowSize--;
            }
            // åœ¨çª—å£æ”¶ç¼©åˆ¤æ–­å®Œä¹‹åæ‰æ›´æ–°ç­”æ¡ˆ
            res = max(res, windowSize);
        }
        return res;
    }
};
```
